# Smart Audit Sampler

This application provides a user-friendly interface for creating audit samples using various statistical and machine learning-based methods. It supports multiple input file formats (CSV, Excel, DBF, JSON, Parquet) and generates a sample along with a detailed PDF report including visualizations.

## Features

* **Statistical Sampling Methods:**
    * Random Sampling
    * Systematic Sampling
    * Stratified Sampling
    * Monetary Unit Sampling (MUS)
* **Machine Learning-Based Sampling Methods:**
    * Isolation Forest
    * Local Outlier Factor (LOF)
    * K-Means Clustering
    * Autoencoder
    * HDBSCAN
* **Data Preprocessing:** Handles numerical and categorical features with appropriate scaling and encoding techniques.
* **Visualization:** Generates charts for strata distribution, cumulative value analysis, and UMAP projections for ML methods.  Also includes visualizations of Optuna hyperparameter optimization results where applicable (K-Means, HDBSCAN).
* **Reporting:** Creates a comprehensive PDF report summarizing the sampling methodology, parameters, and results, including visualizations.
* **Multilingual Support:** Supports both Ukrainian and English languages.
* **Dark Theme UI:** Provides a modern and visually appealing user interface.
* **Performance Logging**:  Logs key events and performance metrics to files within a `logs` directory.  Separate logs for setup, starting, and updating the application provide detailed information about each process.
* **Simplified Launching**:  Uses a `.vbs` script (`start.vbs`) to launch the application via a `loading.bat` script, which activates the virtual environment and runs the main Python script.
* **Automated Setup and Update**:  Includes `setup.bat` for initial environment setup and dependency installation, and `update.bat` for pulling updates from the repository and updating dependencies as needed.  The update process stashes changes to key batch files to prevent overwriting local modifications.


## Installation

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/askakalsky/smart_audit_sampler.git
    ```
2.  **Run the setup script:**

    ```bash
    setup.bat
    ```
    This will create a virtual environment and install the necessary dependencies.

## Usage

1.  **Run the application:**

    ```bash
    start.vbs 
    ```

2.  **Browse and select your data file.**
3.  **Choose a sampling method.**
4.  **Specify required parameters (sample size, strata column, etc.).**
5.  **For ML methods, define column types (numerical/categorical) before creating the sample.**
6.  **Click "Create Sample".**
7.  The sampled data (CSV) and a PDF report will be saved in the same directory as the input file.

## Documentation

Detailed documentation for each sampling method is available in the `docs` folder (in both English and Ukrainian).  These documents describe the methodology, parameters, and potential deviations for each method.  Additionally, `test_results.txt` provides performance metrics on various dataset sizes.

## Project Structure

*   `main.py`: Main application file.
*   `requirements.txt`: List of required Python packages.
*   `start.vbs`: VBScript file to launch the `loading.bat` script.
*   `loading.bat`: Batch file to activate the virtual environment and run `main.py`.
*   `setup.bat`: Batch file for environment setup and dependency installation.
*   `update.bat`: Batch file for updating the application and dependencies.
*   `ml_sampling/`: Contains modules for machine learning-based sampling methods.
*   `statistical_sampling/`: Contains modules for statistical sampling methods.
*   `utils/`: Contains utility functions for visualization and preprocessing.
*   `docs/`: Contains documentation files for each sampling method.
*   `scoring_methods/`: Contains scoring methods for clustering evaluation (e.g., Silhouette).
*   `app/`: Contains the main application logic and UI code.
*   `logs/`: Contains log files generated by `setup.bat`, `loading.bat`, and `update.bat`.


## Contributing

Contributions are welcome!  Please feel free to submit issues or pull requests.

## License

[MIT License](LICENSE)