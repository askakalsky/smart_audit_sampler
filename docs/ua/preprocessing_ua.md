# Опис скрипта

Цей скрипт визначає функцію `preprocess_data`, яка використовується для передобробки даних. Вона виконує кілька завдань з очищення і трансформації даних, таких як one-hot кодування категоріальних ознак, масштабування числових даних і обробка ознак з високою асиметрією (skewness) за допомогою логарифмічного перетворення. Скрипт також налаштовує ведення журналу для відстеження кроків, виконаних під час передобробки.

## Структура скрипта

### Імпортовані бібліотеки:
- `pandas`, `numpy`: Для маніпуляцій з даними та числових операцій.
- `sklearn.preprocessing`: Для масштабування даних за допомогою `StandardScaler` та `MinMaxScaler`.
- `scipy.stats`: Для розрахунку асиметрії в числових ознаках.
- `logging`: Для ведення журналу подій і прогресу під час виконання.
- `datetime`: Для фіксації часу виконання кроків передобробки.

### Основна функція: `preprocess_data`

Функція `preprocess_data` приймає наступні параметри:
- `df`: DataFrame з сирими даними, які необхідно обробити.
- `numerical_columns`: Список назв стовпців, що містять числові ознаки, які потребують масштабування або перетворення.
- `categorical_columns`: Список назв стовпців, що містять категоріальні ознаки, які будуть перетворені на one-hot кодовані.
- `sample_fraction` (необов'язковий): Частка набору даних, яка буде використовуватися (за замовчуванням 1.0, тобто використовується весь набір даних).
- `skew_threshold` (необов'язковий): Поріг асиметрії, вище якого застосовується логарифмічне перетворення (за замовчуванням 0.75).
- `random_seed` (необов'язковий): Насіння для відтворюваності при вибірці даних.

### Кроки передобробки:

1. **Вибірка даних (якщо необхідно):**  
   Функція виконує вибірку даних на основі параметра `sample_fraction`. Якщо частка менше 1.0, вибирається випадкова підмножина даних. У журналі записується процес вибірки.

2. **One-Hot Кодування категоріальних ознак:**  
   Категоріальні стовпці, зазначені в `categorical_columns`, перетворюються на бінарні індикаторні стовпці за допомогою one-hot кодування. Перетворення створює нові стовпці, які фіксуються та записуються у журнал.

3. **Обробка числових даних з асиметрією:**  
   Для числових стовпців обчислюється асиметрія за допомогою функції `scipy.stats.skew`. Якщо асиметрія стовпця перевищує поріг `skew_threshold`, скрипт застосовує логарифмічне перетворення для зменшення асиметрії.

4. **Масштабування:**  
   - Для логарифмічно перетворених (асиметричних) ознак використовується `MinMaxScaler` для масштабування значень у діапазоні від 0 до 1.
   - Для ознак з нормальною розподіленістю (з низькою асиметрією) застосовується `StandardScaler`, який стандартизує дані (нульове середнє і одинична дисперсія).

5. **Фінальний вибір ознак:**  
   Після обробки скрипт залишає лише перетворені числові та новостворені категоріальні ознаки.

### Логування:
Протягом усього процесу створюються журнали для відстеження ключових дій, таких як:
- Вибірка даних.
- Застосування one-hot кодування до категоріальних стовпців.
- Логарифмічне перетворення і масштабування числових стовпців.

Функція повертає:
- `processed_df`: DataFrame з обробленими ознаками (масштабовані числові та one-hot кодовані категоріальні).
- `method_description`: Рядок, що описує кожен застосований крок передобробки даних.
